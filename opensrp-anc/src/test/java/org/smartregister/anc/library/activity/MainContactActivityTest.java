package org.smartregister.anc.library.activity;

import android.app.Activity;
import android.content.Intent;
import android.widget.TextView;

import org.json.JSONException;
import org.json.JSONObject;
import org.junit.After;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.mockito.Mockito;
import org.powermock.reflect.Whitebox;
import org.robolectric.Robolectric;
import org.robolectric.RuntimeEnvironment;
import org.robolectric.android.controller.ActivityController;
import org.smartregister.anc.library.util.ConstantsUtils;

import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;

import timber.log.Timber;

public class MainContactActivityTest extends BaseActivityUnitTest {
    private ActivityController<MainContactActivity> activityController;
    private MainContactActivity activity;

    @Before
    @Override
    public void setUp() {
        super.setUp();
    }

    @Override
    protected Activity getActivity() {
        return activity;
    }

    @Override
    protected ActivityController getActivityController() {
        return activityController;
    }

    @Test
    public void testActivityIsNotNull() {
        Intent intent = new Intent(RuntimeEnvironment.application,
                MainContactActivity.class);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.BASE_ENTITY_ID, DUMMY_BASE_ENTITY_ID);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.CONTACT_NO, 2);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.CLIENT_MAP, new HashMap<>());
        intent.putExtra(ConstantsUtils.IntentKeyUtils.FORM_NAME, ConstantsUtils.JsonFormUtils.ANC_PROFILE);
        activityController = Robolectric.buildActivity(MainContactActivity.class, intent);
        activity = activityController.create().get();
        Assert.assertNotNull(activity);
    }

    @Test
    public void testActivityStartedWithIntent() {
        Intent intent = new Intent(RuntimeEnvironment.application, MainContactActivity.class);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.BASE_ENTITY_ID, DUMMY_BASE_ENTITY_ID);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.CONTACT_NO, 1);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.FORM_NAME, ConstantsUtils.JsonFormUtils.ANC_PROFILE);
        activityController = Robolectric.buildActivity(MainContactActivity.class, intent);
        activity = activityController.create().resume().get();
        Intent passedIntent = activity.getIntent();
        Assert.assertNotNull(passedIntent);
    }

    @Test
    public void testGetRequiredCountTotal() {
        try {
            Intent intent = new Intent(RuntimeEnvironment.application, MainContactActivity.class);
            intent.putExtra(ConstantsUtils.IntentKeyUtils.BASE_ENTITY_ID, DUMMY_BASE_ENTITY_ID);
            intent.putExtra(ConstantsUtils.IntentKeyUtils.CONTACT_NO, 3);
            intent.putExtra(ConstantsUtils.IntentKeyUtils.CLIENT_MAP, new HashMap<>());
            intent.putExtra(ConstantsUtils.IntentKeyUtils.FORM_NAME, ConstantsUtils.JsonFormUtils.ANC_PROFILE);
            activityController = Robolectric.buildActivity(MainContactActivity.class, intent);
            activity = activityController.create().resume().get();
            Assert.assertNotNull(activity);
            Map<String, Integer> requiredFieldsMap = new HashMap<>();
            requiredFieldsMap.put(ConstantsUtils.JsonFormUtils.ANC_PROFILE, 3);
            requiredFieldsMap.put(ConstantsUtils.JsonFormUtils.ANC_TEST_TASKS, 4);
            requiredFieldsMap.put(ConstantsUtils.JsonFormUtils.ANC_SYMPTOMS_FOLLOW_UP, 7);
            requiredFieldsMap.put(ConstantsUtils.JsonFormUtils.ANC_QUICK_CHECK, 1);
            requiredFieldsMap.put(ConstantsUtils.JsonFormUtils.ANC_COUNSELLING_TREATMENT, 10);
            requiredFieldsMap.put(ConstantsUtils.JsonFormUtils.ANC_PHYSICAL_EXAM, 7);
            requiredFieldsMap.put(ConstantsUtils.JsonFormUtils.ANC_TEST, 2);
            Whitebox.setInternalState(activity, "requiredFieldsMap", requiredFieldsMap);

            int requiredFields = Whitebox.invokeMethod(activity, "getRequiredCountTotal");
            Assert.assertEquals(34, requiredFields);
        } catch (Exception e) {
            Timber.e(e, " --> testGetRequiredCountTotal");
        }
    }

    @Test
    public void testDisplayPatientName() {
        Intent intent = new Intent(RuntimeEnvironment.application,
                MainContactActivity.class);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.BASE_ENTITY_ID, DUMMY_BASE_ENTITY_ID);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.CONTACT_NO, 3);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.CLIENT_MAP, new HashMap<>());
        intent.putExtra(ConstantsUtils.IntentKeyUtils.FORM_NAME, ConstantsUtils.JsonFormUtils.ANC_PROFILE);
        activityController = Robolectric.buildActivity(MainContactActivity.class,
                intent);
        activity = activityController.create().resume().get();
        Assert.assertNotNull(activity);
        activity.displayPatientName("WHO ANC");

        TextView name = Whitebox.getInternalState(activity, "patientNameView");
        Assert.assertEquals("WHO ANC", name.getText().toString());
    }

    @Test
    public void testDisplayPatientNameWithNull() {
        Intent intent = new Intent(RuntimeEnvironment.application,
                MainContactActivity.class);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.BASE_ENTITY_ID, DUMMY_BASE_ENTITY_ID);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.CONTACT_NO, 3);
        intent.putExtra(ConstantsUtils.IntentKeyUtils.CLIENT_MAP, new HashMap<>());
        intent.putExtra(ConstantsUtils.IntentKeyUtils.FORM_NAME, ConstantsUtils.JsonFormUtils.ANC_PROFILE);
        activityController = Robolectric.buildActivity(MainContactActivity.class,
                intent);
        activity = activityController.create().resume().get();
        Assert.assertNotNull(activity);
        activity.displayPatientName(null);

        TextView name = Whitebox.getInternalState(activity, "patientNameView");
        Assert.assertEquals("", name.getText().toString());
    }

    @Test
    public void testPreProcessDefaultValues() {
        try {
            Intent intent = new Intent(RuntimeEnvironment.application,
                    MainContactActivity.class);
            intent.putExtra(ConstantsUtils.IntentKeyUtils.BASE_ENTITY_ID, DUMMY_BASE_ENTITY_ID);
            intent.putExtra(ConstantsUtils.IntentKeyUtils.CONTACT_NO, 3);
            intent.putExtra(ConstantsUtils.IntentKeyUtils.CLIENT_MAP, new HashMap<>());
            intent.putExtra(ConstantsUtils.IntentKeyUtils.FORM_NAME, ConstantsUtils.JsonFormUtils.ANC_PROFILE);
            activityController = Robolectric.buildActivity(MainContactActivity.class,
                    intent);
            activity = activityController.create().resume().get();
            Assert.assertNotNull(activity);
            String physicalExam = "{\"validate_on_submit\":true,\"display_scroll_bars\":true,\"count\":\"4\",\"encounter_type\":\"Physical Exam\",\"entity_id\":\"\",\"relational_id\":\"\",\"form_version\":\"0.0.1\",\"default_values\":[\"height\",\"pregest_weight\",\"pregest_weight_unknown\",\"first_weight\",\"no_of_fetuses_unknown\",\"no_of_fetuses\"],\"global_previous\":[\"current_weight\"],\"editable_fields\":[\"height\",\"pregest_weight\",\"pregest_weight_unknown\",\"first_weight\",\"no_of_fetuses_unknown\",\"no_of_fetuses\"],\"metadata\":{\"start\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"start\",\"openmrs_entity_id\":\"163137AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\"end\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"end\",\"openmrs_entity_id\":\"163138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\"today\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"encounter\",\"openmrs_entity_id\":\"encounter_date\"},\"deviceid\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"deviceid\",\"openmrs_entity_id\":\"163149AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\"subscriberid\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"subscriberid\",\"openmrs_entity_id\":\"163150AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\"simserial\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"simserial\",\"openmrs_entity_id\":\"163151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\"phonenumber\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"phonenumber\",\"openmrs_entity_id\":\"163152AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\"encounter_location\":\"\",\"look_up\":{\"entity_id\":\"\",\"value\":\"\"}},\"step1\":{\"title\":\"Height & Weight\",\"next\":\"step2\",\"fields\":[{\"key\":\"height_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Height (cm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true}},{\"key\":\"height\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter the height\"},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"100\",\"err\":\"Height must be equal or greater than 100\"},\"v_max\":{\"value\":\"200\",\"err\":\"Height must be equal or less than 200\"}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pregest_weight_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Pre-gestational weight (kg)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter pre-gestational weight\"},\"relevance\":{\"step1:pregest_weight_unknown\":{\"ex-checkbox\":[{\"not\":[\"pregest_weight_unknown\"]}]}}},{\"key\":\"pregest_weight\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165275AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"relevance\":{\"step1:pregest_weight_unknown\":{\"ex-checkbox\":[{\"not\":[\"pregest_weight_unknown\"]}]}},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"30\",\"err\":\"Weight must be equal or greater than 30\"},\"v_max\":{\"value\":\"180\",\"err\":\"Weight must be equal or less than 180\"},\"v_required\":{\"value\":\"true\",\"err\":\"Pre-gestational weight is required\"}},{\"key\":\"pregest_weight_unknown\",\"openmrs_entity_parent\":\"165277AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"check_box\",\"options\":[{\"key\":\"pregest_weight_unknown\",\"text\":\"Pre-gestational weight unknown\",\"value\":\"false\",\"openmrs_entity_parent\":\"165277AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"current_weight_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Current weight (kg)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true}},{\"key\":\"current_weight\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"30\",\"err\":\"Weight must be equal or greater than 30\"},\"v_max\":{\"value\":\"180\",\"err\":\"Weight must be equal or less than 180\"},\"v_required\":{\"value\":\"true\",\"err\":\"Please enter the current weight\"}},{\"key\":\"first_weight\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"bmi\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1342AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"gdm_risk\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165261AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"weight_cat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"exp_weight_gain\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"weight_gain_duration\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"weight_gain\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"tot_weight_gain\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster1\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"Body mass Index\",\"openmrs_entity_id\":\"1432\",\"type\":\"toaster_notes\",\"text\":\"Body mass index (BMI) = {bmi}\\n\\nWoman is {weight_cat}. Weight gain during pregnancy should be {exp_weight_gain} kg.\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster2\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"Weight gain finding\",\"openmrs_entity_id\":\"122887\",\"type\":\"toaster_notes\",\"text\":\"Average weight gain per week since last contact: {weight_gain} kg\\n\\nTotal weight gain in pregnancy so far: {tot_weight_gain} kg\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster3\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Gestational diabetes mellitus (GDM) risk counseling\",\"text_color\":\"#D56900\",\"toaster_info_text\":\"Please provide appropriate counseling for GDM risk mitigation, including:\\n- Reasserting dietary interventions\\n- Reasserting physical activity during pregnancy\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster4\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Healthy eating and keeping physically active counseling\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"toaster_info_text\":\"Healthy eating and keeping physically active during pregnancy is recommended for pregnant women to stay healthy and to prevent excessive weight gain during pregnancy.\",\"toaster_info_title\":\"Nutritional and Exercise Folder\"},{\"key\":\"toaster5\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"Weight gain finding\",\"openmrs_entity_id\":\"122887\",\"type\":\"toaster_notes\",\"text\":\"Increase daily energy and protein intake counseling\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"toaster_info_text\":\"Increase daily energy and protein intake to reduce the risk of low-birth-weight neonates.\",\"toaster_info_title\":\"Increase daily energy and protein intake counseling\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster6\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"Weight gain finding\",\"openmrs_entity_id\":\"122887\",\"type\":\"toaster_notes\",\"text\":\"Balanced energy and protein dietary supplementation counseling\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"toaster_info_text\":\"Balanced energy and protein dietary supplementation is recommended for pregnant women to reduce the risk of stillbirths and small-for-gestational-age neonates.\",\"toaster_info_title\":\"Balanced energy and protein dietary supplementation counseling\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}}]},\"step2\":{\"title\":\"Blood Pressure\",\"next\":\"step3\",\"fields\":[{\"key\":\"bp_systolic_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Systolic blood pressure (SBP) (mmHg)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}}},{\"key\":\"bp_systolic\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"SBP must be equal or greater than 20\"},\"v_max\":{\"value\":\"260\",\"err\":\"SBP must be equal or less than 260\"},\"v_required\":{\"value\":\"true\",\"err\":\"Field systolic is required\"},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\",\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}}},{\"key\":\"bp_diastolic_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Diastolic blood pressure (DBP) (mmHg)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}}},{\"key\":\"bp_diastolic\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"DBP must be equal to or greater than 20\"},\"v_max\":{\"value\":\"260\",\"err\":\"DBP must be equal to or less than 260\"},\"v_required\":{\"value\":\"true\",\"err\":\"Field diastolic is required\"},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}}},{\"key\":\"cant_record_bp\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"check_box\",\"options\":[{\"key\":\"cant_record_bp\",\"text\":\"Unable to record BP\",\"value\":false,\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\"}]},{\"key\":\"cant_record_bp_reason\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165428AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"label\":\"Reason\",\"type\":\"check_box\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"bp_cuff_unavailable\",\"text\":\"BP cuff (sphygmomanometer) not available\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165386AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"bp_cuff_broken\",\"text\":\"BP cuff (sphygmomanometer) is broken\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165179AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"other\",\"text\":\"Other\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Reason why SBP and DPB is cannot be done is required\"},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"or\":[\"cant_record_bp\"]}]}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"toaster7\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Measure BP again after 10-15 minutes rest.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"bp_systolic_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"SBP after 10-15 minutes rest\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"bp_systolic_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165278AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"SBP must be equal or greater than 20\"},\"v_max\":{\"value\":\"260\",\"err\":\"SBP must be equal or less than 260\"},\"v_required\":{\"value\":\"true\",\"err\":\"Field systolic repeat is required\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"bp_diastolic_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"DBP after 10-15 minutes rest\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"bp_diastolic_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165279AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"DBP must be equal or greater than 20\"},\"v_max\":{\"value\":\"260\",\"err\":\"DBP must be equal or less than 260\"},\"v_required\":{\"value\":\"true\",\"err\":\"Field diastolic repeat is required\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster8\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Do urine dipstick test for protein.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"symp_sev_preeclampsia\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165280AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"check_box\",\"label\":\"Any symptoms of severe pre-eclampsia?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"exclusive\":[\"none\"],\"options\":[{\"key\":\"none\",\"text\":\"None\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"severe_headache\",\"text\":\"Severe headache\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"139081AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"visual_disturbance\",\"text\":\"Blurred vision\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"147104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"epigastric_pain\",\"text\":\"Epigastric pain\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"141128AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"dizziness\",\"text\":\"Dizziness\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"156046AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"vomiting\",\"text\":\"Vomiting\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"122983AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Please specify any other symptoms or select none\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"urine_protein\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Urine dipstick result - protein\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"none\",\"text\":\"None\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"+\",\"text\":\"+\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1362AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"++\",\"text\":\"++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1363AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"+++\",\"text\":\"+++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1364AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"++++\",\"text\":\"++++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1365AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Please enter the result for the dipstick test.\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"hypertension\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"47AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"severe_hypertension\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165205AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster9\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Hypertension diagnosis! Provide counseling.\",\"toaster_info_text\":\"Woman has hypertension - SBP of 140 mmHg or higher and/or DBP of 90 mmHg or higher and no proteinuria.\\\\n\\\\nCounseling:\\n- Advice to reduce workload and to rest\\n- Advise on danger signs\\n- Reassess at the next contact or in 1 week if 8 months pregnant\\n- If hypertension persists after 1 week or at next contact, refer to hospital or discuss case with the doctor, if available\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster10\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Severe hypertension! Refer urgently to hospital!\",\"toaster_info_text\":\"Woman has severe hypertension. If SBP is 160 mmHg or higher and/or DBP is 110 mmHg or higher, then refer urgently to the hospital for further investigation and management.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster11\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Symptom(s) of severe pre-eclampsia! Refer urgently to hospital!\",\"toaster_info_text\":\"Woman has hypertension. If she is experiencing a symptom of severe pre-eclampsia, then refer urgently to the hospital for further investigation and management.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"severe_preeclampsia\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"113006AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster13\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Severe pre-eclampsia diagnosis! Provide urgent treatment and refer to hospital!\",\"toaster_info_text\":\"Woman has severe pre-eclampsia - SBP of 160 mmHg or above and/or DBP of 110 mmHg or above and proteinuria 3+ OR woman has SBP of 140 mmHg or above and/or DBP of 90 mmHg or above and proteinuria 2+ with at least one symptom of severe pre-eclampsia.\\n\\nProcedure:\\n- Give magnesium sulphate\\n- Give appropriate anti-hypertensives\\n- Revise the birth plan\\n- Refer urgently to hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"preeclampsia\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"129251AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster14\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Pre-eclampsia diagnosis! Refer to hospital and revise birth plan.\",\"toaster_info_text\":\"Woman has pre-eclampsia - SBP of 140 mmHg or above and/or DBP of 90 mmHg or above and proteinuria 2+ and no symptom of severe pre-eclampsia.\\n\\nProcedure:\\n- Refer to hospital\\n- Revise the birth plan\",\"toaster_info_title\":\"Pre-eclampsia diagnosis! Refer to hospital and revise birth plan.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}}]},\"step3\":{\"title\":\"Maternal Exam\",\"next\":\"step4\",\"fields\":[{\"key\":\"body_temp_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Temperature (ºC)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true}},{\"key\":\"body_temp\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter body temperature\"},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"35\",\"err\":\"Temperature must be equal to or greater than 35\"},\"v_max\":{\"value\":\"42\",\"err\":\"Temperature must be equal to or less than 42\"}},{\"key\":\"toaster15\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Temperature of 38ºC or above! Measure temperature again.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"step3:body_temp\":{\"type\":\"numeric\",\"ex\":\"greaterThanEqualTo(., \\\"38\\\")\"}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"body_temp_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Second temperature (ºC)\",\"text_color\":\"#000000\",\"label_info_text\":\"Retake the woman's temperature if the first reading was 38ºC or higher.\",\"v_required\":{\"value\":true},\"relevance\":{\"step3:body_temp\":{\"type\":\"numeric\",\"ex\":\"greaterThanEqualTo(., \\\"38\\\")\"}}},{\"key\":\"body_temp_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter second body temperature\"},\"relevance\":{\"step3:body_temp\":{\"type\":\"numeric\",\"ex\":\"greaterThanEqualTo(., \\\"38\\\")\"}},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"35\",\"err\":\"Temperature must be equal to or greater than 35\"},\"v_max\":{\"value\":\"42\",\"err\":\"Temperature must be equal to or less than 42\"}},{\"key\":\"toaster16\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Woman has a fever. Provide treatment and refer urgently to hospital!\",\"toaster_info_text\":\"Procedure:\\n- Insert an IV line\\n- Give fluids slowly\\n- Refer urgently to hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"step3:body_temp_repeat\":{\"type\":\"numeric\",\"ex\":\"greaterThanEqualTo(., \\\"38\\\")\"}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pulse_rate_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Pulse rate (kpm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true}},{\"key\":\"pulse_rate\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter pulse rate\"},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"Pulse rate must be equal to or greater than 20\"},\"v_max\":{\"value\":\"200\",\"err\":\"Pulse rate must be equal to or less than 200\"}},{\"key\":\"toaster17\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal pulse rate. Check again after 10 minutes rest.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pulse_rate_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Second pulse rate (kpm)\",\"label_info_text\":\"Retake the woman's pulse rate if the first reading was lower than 60 or higher than 100.\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"pulse_rate_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"Pulse rate must be equal to or greater than 20\"},\"v_max\":{\"value\":\"200\",\"err\":\"Pulse rate must be equal to or less than 200\"},\"v_required\":{\"value\":\"true\",\"err\":\"Please enter repeated pulse rate\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster18\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal pulse rate. Refer for further investigation.\",\"toaster_info_text\":\"Procedure:\\n- Check for fever, infection, respiratory distress, and arrhythmia\\n- Refer for further investigation\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pallor\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5245AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Pallor present?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"yes\",\"text\":\"Yes\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"no\",\"text\":\"No\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"anaemic\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"121629AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster19\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Anaemia diagnosis! Haemoglobin (Hb) test recommended.\",\"toaster_info_text\":\"Anaemia - Hb level less than 11 in first or third trimester or Hb level less than 10.5 in second trimester.\\n\\nOR\\n\\nNo Hb test result recorded, but woman has pallor.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"respiratory_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Respiratory exam\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"respiratory_exam_sub_form\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"toaster20\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Woman has respiratory distress. Refer urgently to the hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"step3:respiratory_exam\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"3\\\")\"}}},{\"key\":\"oximetry_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Oximetry (%)\",\"text_color\":\"#000000\",\"relevance\":{\"step3:respiratory_exam\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"3\\\")\"}}},{\"key\":\"oximetry\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5092AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"relevance\":{\"step3:respiratory_exam\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"3\\\")\"}}},{\"key\":\"toaster21\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Woman has low oximetry. Refer urgently to the hospital!\",\"toaster_info_text\":\"Procedure:\\n- Give oxygen\\n- Refer urgently to hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"cardiac_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Cardiac exam\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"cardiac_exam_sub_form\",\"openmrs_entity_parent\":\"165368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"toaster22\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal cardiac exam. Refer urgently to the hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"breast_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165369AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Breast exam\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165369AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165369AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"breast_exam_sub_form\",\"openmrs_entity_parent\":\"165369AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"toaster23\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal breast exam. Refer for further investigation.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"abdominal_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165370AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Abdominal exam\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165370AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165370AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"abdominal_exam_sub_form\",\"openmrs_entity_parent\":\"165370AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"toaster24\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal abdominal exam. Consider high level evaluation or referral.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pelvic_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165373AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Pelvic exam (visual)\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165373AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165373AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"pelvic_exam_sub_form\",\"openmrs_entity_parent\":\"165373AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"toaster25\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal pelvic exam. Consider high level evaluation, specific syndromic treatment or referral.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"cervical_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Cervical exam done?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"1\",\"options\":[{\"key\":\"1\",\"text\":\"Done\",\"openmrs_entity_parent\":\"165374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"1267AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"specify_info\":\"specify cm cervix dilated...\",\"specify_widget\":\"normal_edit_text\",\"specify_info_color\":\"#8C8C8C\",\"secondary_suffix\":\"cm\",\"content_form\":\"cervical_exam_sub_form\"},{\"key\":\"2\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"toaster26_hidden\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}},\"src\":{\"key\":\"cervical_exam\",\"option_key\":\"1\",\"stepName\":\"step3\"}}},{\"key\":\"toaster26\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Cervix is more than 2 cm dilated. Please check for other signs and symptoms of labour (if GA is 37 weeks or later) or pre-term labour and other related complications (if GA is less than 37 weeks).\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"oedema\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Oedema present?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"yes\",\"options\":[{\"key\":\"yes\",\"text\":\"Yes\",\"specify_info\":\"specify type...\",\"specify_widget\":\"radio_button\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"oedema_present_sub_form\",\"openmrs_entity_parent\":\"460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"no\",\"text\":\"No\",\"openmrs_entity_parent\":\"460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"oedema_severity\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Oedema severity\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"+\",\"text\":\"+\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1362AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"++\",\"text\":\"++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1363AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"+++\",\"text\":\"+++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1364AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"++++\",\"text\":\"++++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1365AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"v_required\":{\"value\":\"false\",\"err\":\"Please enter the result for the dipstick test.\"},\"relevance\":{\"step3:oedema\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"yes\\\")\"}}}]},\"step4\":{\"title\":\"Fetal Assessment\",\"fields\":[{\"key\":\"sfh_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Symphysis-fundal height (SFH) in centimetres (cm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":false}},{\"key\":\"sfh\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1439AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_min\":{\"value\":\"0.1\",\"err\":\"SFH must be greater than 0\"},\"v_max\":{\"value\":\"44\",\"err\":\"SFH must be less than or equal to 44\"},\"v_numeric_integer\":{\"value\":\"true\",\"err\":\"Enter a valid sfh\"},\"v_required\":{\"value\":\"false\",\"err\":\"Please enter the SFH\"}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"fetal_movement\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165376AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Fetal movement felt?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"yes\",\"text\":\"Yes\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"165376AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"no\",\"text\":\"No\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"165376AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"v_required\":{\"value\":\"false\",\"err\":\"Please this field is required.\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"fetal_heartbeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165377AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Fetal heartbeat present?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"yes\",\"text\":\"Yes\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"165377AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"no\",\"text\":\"No\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"165377AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Please specify if fetal heartbeat is present.\"}},{\"key\":\"fetal_heart_rate_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Fetal heart rate (kpm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":\"true\",\"err\":\"Please specify if fetal heartbeat is present.\"},\"relevance\":{\"step4:fetal_heartbeat\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"yes\\\")\"}}},{\"key\":\"fetal_heart_rate\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1440AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_min\":{\"value\":\"80\",\"err\":\"Fetal heartbeat must be equal or greater than 80\"},\"v_max\":{\"value\":\"200\",\"err\":\"Fetal heartbeat must be less than or equal to 200\"},\"v_numeric_integer\":{\"value\":\"true\",\"err\":\"Enter a valid sfh\"},\"relevance\":{\"step4:fetal_heartbeat\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"yes\\\")\"}},\"v_required\":{\"value\":\"true\",\"err\":\"Please specify if fetal heartbeat is present.\"}},{\"key\":\"toaster27\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"No fetal heartbeat observed. Refer to hospital.\",\"toaster_info_text\":\"Procedure:\\n- Inform the woman that you cannot find the heartbeat and need to refer her to check if there's a problem.\\n- Refer to hospital.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster28\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Fetal heart rate out of normal range (110-160). Please have the woman lay on her left side for 15 minutes and check again.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"fetal_heart_rate_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Second fetal heart rate (kpm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"fetal_heart_rate_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1440AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter result for the second fetal heart rate\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster29\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal fetal heart rate. Refer to hospital.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"no_of_fetuses_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"No. of fetuses\",\"text_color\":\"#000000\",\"v_required\":{\"value\":false},\"relevance\":{\"step4:no_of_fetuses_unknown\":{\"ex-checkbox\":[{\"not\":[\"no_of_fetuses_unknown\"]}]}}},{\"key\":\"no_of_fetuses\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165293AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"numbers_selector\",\"number_of_selectors\":\"5\",\"start_number\":\"1\",\"max_value\":\"8\",\"text_size\":\"16px\",\"text_color\":\"#000000\",\"selected_text_color\":\"#ffffff\",\"v_required\":{\"value\":false},\"relevance\":{\"step4:no_of_fetuses_unknown\":{\"ex-checkbox\":[{\"not\":[\"no_of_fetuses_unknown\"]}]}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\",\"relevance\":{\"step4:no_of_fetuses_unknown\":{\"ex-checkbox\":[{\"not\":[\"no_of_fetuses_unknown\"]}]}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"no_of_fetuses_unknown\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165294AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"check_box\",\"options\":[{\"key\":\"no_of_fetuses_unknown\",\"text\":\"No. of fetuses unknown\",\"value\":\"false\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165294AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"preeclampsia_risk\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165260AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster30\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Pre-eclampsia risk counseling\",\"text_color\":\"#D56900\",\"toaster_info_text\":\"The use of aspirin after 12 weeks gestation is recommended as well as calcium if low dietary intake area. Please also provide counseling. \",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"fetal_presentation\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"160090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Fetal presentation\",\"label_text_style\":\"bold\",\"label_info_text\":\"If multiple fetuses, indicate the fetal position of the first fetus to be delivered.\",\"options\":[{\"key\":\"unknown\",\"text\":\"Unknown\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"cephalic\",\"text\":\"Cephalic\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"160091AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"pelvic\",\"text\":\"Pelvic\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"146922AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"transverse\",\"text\":\"Transverse\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"112259AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"other\",\"text\":\"Other\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Fetal representation field is required\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}}]}}";
            JSONObject physicalExamJson = new JSONObject(physicalExam);

            Whitebox.invokeMethod(activity, "preProcessDefaultValues", physicalExamJson);
        } catch (JSONException e) {
            Timber.e(e, " --> testPreProcessDefaultValues");
        } catch (Exception e) {
            Timber.e(e, " --> testPreProcessDefaultValues");
        }
    }

    @Test
    public void testContact() throws Exception {
        String partialForm = "{\"validate_on_submit\":true,\"display_scroll_bars\":true,\"count\":\"4\",\"encounter_type\":\"Physical Exam\",\"entity_id\":\"\",\"relational_id\":\"\",\"form_version\":\"0.0.1\",\"default_values\":[\"height\",\"pregest_weight\",\"pregest_weight_unknown\",\"first_weight\",\"no_of_fetuses_unknown\",\"no_of_fetuses\"],\"global_previous\":[\"current_weight\"],\"editable_fields\":[\"height\",\"pregest_weight\",\"pregest_weight_unknown\",\"first_weight\",\"no_of_fetuses_unknown\",\"no_of_fetuses\"],\"metadata\":{\"start\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"start\",\"openmrs_entity_id\":\"163137AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"value\":\"2020-02-19 17:51:33\"},\"end\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"end\",\"openmrs_entity_id\":\"163138AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\"today\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"encounter\",\"openmrs_entity_id\":\"encounter_date\"},\"deviceid\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"deviceid\",\"openmrs_entity_id\":\"163149AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"value\":\"358240051111110\"},\"subscriberid\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"subscriberid\",\"openmrs_entity_id\":\"163150AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"value\":\"310260000000000\"},\"simserial\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"simserial\",\"openmrs_entity_id\":\"163151AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"value\":\"89014103211118510720\"},\"phonenumber\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_data_type\":\"phonenumber\",\"openmrs_entity_id\":\"163152AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"value\":\"+15555215554\"},\"encounter_location\":\"44de66fb-e6c6-4bae-92bb-386dfe626eba\",\"look_up\":{\"entity_id\":\"\",\"value\":\"\"}},\"step1\":{\"title\":\"Height & Weight\",\"next\":\"step2\",\"fields\":[{\"key\":\"height_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Height (cm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true}},{\"key\":\"height\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter the height\"},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"100\",\"err\":\"Height must be equal or greater than 100\"},\"v_max\":{\"value\":\"200\",\"err\":\"Height must be equal or less than 200\"},\"value\":\"123\",\"editable\":true,\"read_only\":true,\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pregest_weight_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Pre-gestational weight (kg)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter pre-gestational weight\"},\"relevance\":{\"step1:pregest_weight_unknown\":{\"ex-checkbox\":[{\"not\":[\"pregest_weight_unknown\"]}]}},\"is_visible\":true},{\"key\":\"pregest_weight\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165275AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"relevance\":{\"step1:pregest_weight_unknown\":{\"ex-checkbox\":[{\"not\":[\"pregest_weight_unknown\"]}]}},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"30\",\"err\":\"Weight must be equal or greater than 30\"},\"v_max\":{\"value\":\"180\",\"err\":\"Weight must be equal or less than 180\"},\"v_required\":{\"value\":\"true\",\"err\":\"Pre-gestational weight is required\"},\"value\":\"45\",\"editable\":true,\"read_only\":true,\"step\":\"step1\",\"is-rule-check\":true,\"is_visible\":true},{\"key\":\"pregest_weight_unknown\",\"openmrs_entity_parent\":\"165277AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"check_box\",\"options\":[{\"key\":\"pregest_weight_unknown\",\"text\":\"Pre-gestational weight unknown\",\"value\":\"false\",\"openmrs_entity_parent\":\"165277AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"step\":\"step1\",\"is-rule-check\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"current_weight_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Current weight (kg)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true}},{\"key\":\"current_weight\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"30\",\"err\":\"Weight must be equal or greater than 30\"},\"v_max\":{\"value\":\"180\",\"err\":\"Weight must be equal or less than 180\"},\"v_required\":{\"value\":\"true\",\"err\":\"Please enter the current weight\"},\"step\":\"step1\",\"is-rule-check\":true,\"value\":\"\"},{\"key\":\"first_weight\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"45\",\"editable\":true,\"read_only\":true,\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"bmi\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1342AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"29.74\",\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"gdm_risk\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165261AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"0\",\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"weight_cat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"Overweight\",\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"exp_weight_gain\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"7 - 11.5\",\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"weight_gain_duration\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"1\",\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"weight_gain\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"0\",\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"tot_weight_gain\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"-45\",\"step\":\"step1\",\"is-rule-check\":true},{\"key\":\"toaster1\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"Body mass Index\",\"openmrs_entity_id\":\"1432\",\"type\":\"toaster_notes\",\"text\":\"Body mass index (BMI) = {bmi}\\n\\nWoman is {weight_cat}. Weight gain during pregnancy should be {exp_weight_gain} kg.\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster2\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"Weight gain finding\",\"openmrs_entity_id\":\"122887\",\"type\":\"toaster_notes\",\"text\":\"Average weight gain per week since last contact: {weight_gain} kg\\n\\nTotal weight gain in pregnancy so far: {tot_weight_gain} kg\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster3\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Gestational diabetes mellitus (GDM) risk counseling\",\"text_color\":\"#D56900\",\"toaster_info_text\":\"Please provide appropriate counseling for GDM risk mitigation, including:\\n- Reasserting dietary interventions\\n- Reasserting physical activity during pregnancy\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"toaster4\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Healthy eating and keeping physically active counseling\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"toaster_info_text\":\"Healthy eating and keeping physically active during pregnancy is recommended for pregnant women to stay healthy and to prevent excessive weight gain during pregnancy.\",\"toaster_info_title\":\"Nutritional and Exercise Folder\"},{\"key\":\"toaster5\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"Weight gain finding\",\"openmrs_entity_id\":\"122887\",\"type\":\"toaster_notes\",\"text\":\"Increase daily energy and protein intake counseling\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"toaster_info_text\":\"Increase daily energy and protein intake to reduce the risk of low-birth-weight neonates.\",\"toaster_info_title\":\"Increase daily energy and protein intake counseling\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"toaster6\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"Weight gain finding\",\"openmrs_entity_id\":\"122887\",\"type\":\"toaster_notes\",\"text\":\"Balanced energy and protein dietary supplementation counseling\",\"text_color\":\"#1199F9\",\"toaster_type\":\"info\",\"toaster_info_text\":\"Balanced energy and protein dietary supplementation is recommended for pregnant women to reduce the risk of stillbirths and small-for-gestational-age neonates.\",\"toaster_info_title\":\"Balanced energy and protein dietary supplementation counseling\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false}]},\"step2\":{\"title\":\"Blood Pressure\",\"next\":\"step3\",\"fields\":[{\"key\":\"bp_systolic_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Systolic blood pressure (SBP) (mmHg)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}},\"is_visible\":true},{\"key\":\"bp_systolic\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5085AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"SBP must be equal or greater than 20\"},\"v_max\":{\"value\":\"260\",\"err\":\"SBP must be equal or less than 260\"},\"v_required\":{\"value\":\"true\",\"err\":\"Field systolic is required\"},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}},\"is_visible\":true,\"step\":\"step2\",\"is-rule-check\":true,\"value\":\"\"},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\",\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}},\"is_visible\":true},{\"key\":\"bp_diastolic_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Diastolic blood pressure (DBP) (mmHg)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}},\"is_visible\":true},{\"key\":\"bp_diastolic\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5086AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"DBP must be equal to or greater than 20\"},\"v_max\":{\"value\":\"260\",\"err\":\"DBP must be equal to or less than 260\"},\"v_required\":{\"value\":\"true\",\"err\":\"Field diastolic is required\"},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"not\":[\"cant_record_bp\"]}]}},\"is_visible\":true,\"step\":\"step2\",\"is-rule-check\":true,\"value\":\"\"},{\"key\":\"cant_record_bp\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"check_box\",\"options\":[{\"key\":\"cant_record_bp\",\"text\":\"Unable to record BP\",\"value\":false,\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\"}],\"is-rule-check\":false},{\"key\":\"cant_record_bp_reason\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165428AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"label\":\"Reason\",\"type\":\"check_box\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"bp_cuff_unavailable\",\"text\":\"BP cuff (sphygmomanometer) not available\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165386AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"bp_cuff_broken\",\"text\":\"BP cuff (sphygmomanometer) is broken\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165179AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"other\",\"text\":\"Other\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Reason why SBP and DPB is cannot be done is required\"},\"relevance\":{\"step2:cant_record_bp\":{\"ex-checkbox\":[{\"or\":[\"cant_record_bp\"]}]}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"toaster7\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Measure BP again after 10-15 minutes rest.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"bp_systolic_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"SBP after 10-15 minutes rest\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"bp_systolic_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165278AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"SBP must be equal or greater than 20\"},\"v_max\":{\"value\":\"260\",\"err\":\"SBP must be equal or less than 260\"},\"v_required\":{\"value\":\"true\",\"err\":\"Field systolic repeat is required\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"step\":\"step2\",\"is-rule-check\":true,\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"bp_diastolic_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"DBP after 10-15 minutes rest\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"bp_diastolic_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165279AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"DBP must be equal or greater than 20\"},\"v_max\":{\"value\":\"260\",\"err\":\"DBP must be equal or less than 260\"},\"v_required\":{\"value\":\"true\",\"err\":\"Field diastolic repeat is required\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"step\":\"step2\",\"is-rule-check\":true,\"is_visible\":false},{\"key\":\"toaster8\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Do urine dipstick test for protein.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"symp_sev_preeclampsia\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165280AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"check_box\",\"label\":\"Any symptoms of severe pre-eclampsia?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"exclusive\":[\"none\"],\"options\":[{\"key\":\"none\",\"text\":\"None\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1107AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"severe_headache\",\"text\":\"Severe headache\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"139081AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"visual_disturbance\",\"text\":\"Blurred vision\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"147104AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"epigastric_pain\",\"text\":\"Epigastric pain\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"141128AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"dizziness\",\"text\":\"Dizziness\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"156046AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"vomiting\",\"text\":\"Vomiting\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"122983AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Please specify any other symptoms or select none\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"step\":\"step2\",\"is-rule-check\":true,\"is_visible\":false},{\"key\":\"urine_protein\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Urine dipstick result - protein\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"none\",\"text\":\"None\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"+\",\"text\":\"+\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1362AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"++\",\"text\":\"++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1363AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"+++\",\"text\":\"+++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1364AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"1875AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"++++\",\"text\":\"++++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1365AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Please enter the result for the dipstick test.\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"step\":\"step2\",\"is-rule-check\":true,\"is_visible\":false},{\"key\":\"hypertension\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"47AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"0\",\"step\":\"step2\",\"is-rule-check\":true},{\"key\":\"severe_hypertension\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165205AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"0\",\"step\":\"step2\",\"is-rule-check\":true},{\"key\":\"toaster9\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Hypertension diagnosis! Provide counseling.\",\"toaster_info_text\":\"Woman has hypertension - SBP of 140 mmHg or higher and\\/or DBP of 90 mmHg or higher and no proteinuria.\\\\n\\\\nCounseling:\\n- Advice to reduce workload and to rest\\n- Advise on danger signs\\n- Reassess at the next contact or in 1 week if 8 months pregnant\\n- If hypertension persists after 1 week or at next contact, refer to hospital or discuss case with the doctor, if available\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"toaster10\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Severe hypertension! Refer urgently to hospital!\",\"toaster_info_text\":\"Woman has severe hypertension. If SBP is 160 mmHg or higher and\\/or DBP is 110 mmHg or higher, then refer urgently to the hospital for further investigation and management.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"toaster11\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Symptom(s) of severe pre-eclampsia! Refer urgently to hospital!\",\"toaster_info_text\":\"Woman has hypertension. If she is experiencing a symptom of severe pre-eclampsia, then refer urgently to the hospital for further investigation and management.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"severe_preeclampsia\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"113006AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"0\",\"step\":\"step2\",\"is-rule-check\":true},{\"key\":\"toaster13\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Severe pre-eclampsia diagnosis! Provide urgent treatment and refer to hospital!\",\"toaster_info_text\":\"Woman has severe pre-eclampsia - SBP of 160 mmHg or above and\\/or DBP of 110 mmHg or above and proteinuria 3+ OR woman has SBP of 140 mmHg or above and\\/or DBP of 90 mmHg or above and proteinuria 2+ with at least one symptom of severe pre-eclampsia.\\n\\nProcedure:\\n- Give magnesium sulphate\\n- Give appropriate anti-hypertensives\\n- Revise the birth plan\\n- Refer urgently to hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"preeclampsia\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"129251AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"0\",\"step\":\"step2\",\"is-rule-check\":true},{\"key\":\"toaster14\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Pre-eclampsia diagnosis! Refer to hospital and revise birth plan.\",\"toaster_info_text\":\"Woman has pre-eclampsia - SBP of 140 mmHg or above and\\/or DBP of 90 mmHg or above and proteinuria 2+ and no symptom of severe pre-eclampsia.\\n\\nProcedure:\\n- Refer to hospital\\n- Revise the birth plan\",\"toaster_info_title\":\"Pre-eclampsia diagnosis! Refer to hospital and revise birth plan.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false}]},\"step3\":{\"title\":\"Maternal Exam\",\"next\":\"step4\",\"fields\":[{\"key\":\"body_temp_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Temperature (ºC)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true}},{\"key\":\"body_temp\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter body temperature\"},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"35\",\"err\":\"Temperature must be equal to or greater than 35\"},\"v_max\":{\"value\":\"42\",\"err\":\"Temperature must be equal to or less than 42\"},\"is-rule-check\":false},{\"key\":\"toaster15\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Temperature of 38ºC or above! Measure temperature again.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"step3:body_temp\":{\"type\":\"numeric\",\"ex\":\"greaterThanEqualTo(., \\\"38\\\")\"}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"body_temp_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Second temperature (ºC)\",\"text_color\":\"#000000\",\"label_info_text\":\"Retake the woman's temperature if the first reading was 38ºC or higher.\",\"v_required\":{\"value\":true},\"relevance\":{\"step3:body_temp\":{\"type\":\"numeric\",\"ex\":\"greaterThanEqualTo(., \\\"38\\\")\"}},\"is_visible\":false},{\"key\":\"body_temp_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5088AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter second body temperature\"},\"relevance\":{\"step3:body_temp\":{\"type\":\"numeric\",\"ex\":\"greaterThanEqualTo(., \\\"38\\\")\"}},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"35\",\"err\":\"Temperature must be equal to or greater than 35\"},\"v_max\":{\"value\":\"42\",\"err\":\"Temperature must be equal to or less than 42\"},\"is_visible\":false,\"is-rule-check\":false},{\"key\":\"toaster16\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Woman has a fever. Provide treatment and refer urgently to hospital!\",\"toaster_info_text\":\"Procedure:\\n- Insert an IV line\\n- Give fluids slowly\\n- Refer urgently to hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"step3:body_temp_repeat\":{\"type\":\"numeric\",\"ex\":\"greaterThanEqualTo(., \\\"38\\\")\"}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pulse_rate_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Pulse rate (kpm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true}},{\"key\":\"pulse_rate\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter pulse rate\"},\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"Pulse rate must be equal to or greater than 20\"},\"v_max\":{\"value\":\"200\",\"err\":\"Pulse rate must be equal to or less than 200\"},\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster17\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal pulse rate. Check again after 10 minutes rest.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pulse_rate_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Second pulse rate (kpm)\",\"label_info_text\":\"Retake the woman's pulse rate if the first reading was lower than 60 or higher than 100.\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"pulse_rate_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5087AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_numeric\":{\"value\":\"true\",\"err\":\"\"},\"v_min\":{\"value\":\"20\",\"err\":\"Pulse rate must be equal to or greater than 20\"},\"v_max\":{\"value\":\"200\",\"err\":\"Pulse rate must be equal to or less than 200\"},\"v_required\":{\"value\":\"true\",\"err\":\"Please enter repeated pulse rate\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false,\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster18\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal pulse rate. Refer for further investigation.\",\"toaster_info_text\":\"Procedure:\\n- Check for fever, infection, respiratory distress, and arrhythmia\\n- Refer for further investigation\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pallor\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5245AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Pallor present?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"yes\",\"text\":\"Yes\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"no\",\"text\":\"No\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"anaemic\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"121629AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}},\"value\":\"0\",\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster19\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Anaemia diagnosis! Haemoglobin (Hb) test recommended.\",\"toaster_info_text\":\"Anaemia - Hb level less than 11 in first or third trimester or Hb level less than 10.5 in second trimester.\\n\\nOR\\n\\nNo Hb test result recorded, but woman has pallor.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"respiratory_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Respiratory exam\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"respiratory_exam_sub_form\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"secondary_value\":[{\"key\":\"respiratory_exam_abnormal\",\"type\":\"check_box\",\"values\":[\"dyspnoea:Dyspnoea:true\",\"cough:Cough:true\",\"rapid_breathing:Rapid breathing:true\",\"slow_breathing:Slow breathing:true\",\"wheezing:Wheezing:true\",\"rales:Rales:true\",\"other:Other (specify):true\"],\"openmrs_attributes\":{\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1123AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},\"value_openmrs_attributes\":[{\"key\":\"respiratory_exam_abnormal\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"122496AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"respiratory_exam_abnormal\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"143264AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"respiratory_exam_abnormal\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"125061AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"respiratory_exam_abnormal\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"126356AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"respiratory_exam_abnormal\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5209AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"respiratory_exam_abnormal\",\"openmrs_entity_parent\":\"165367AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"127640AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"respiratory_exam_abnormal\",\"openmrs_entity_parent\":\"1123AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"respiratory_exam_abnormal_other\",\"type\":\"edit_text\",\"values\":[\"More tests\"],\"openmrs_attributes\":{\"openmrs_entity_parent\":\"1123AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"160632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}}]}],\"is-rule-check\":false,\"value\":\"3\"},{\"key\":\"toaster20\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Woman has respiratory distress. Refer urgently to the hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"step3:respiratory_exam\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"3\\\")\"}},\"is_visible\":true},{\"key\":\"oximetry_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Oximetry (%)\",\"text_color\":\"#000000\",\"relevance\":{\"step3:respiratory_exam\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"3\\\")\"}},\"is_visible\":true},{\"key\":\"oximetry\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5092AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"relevance\":{\"step3:respiratory_exam\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"3\\\")\"}},\"is_visible\":true,\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster21\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Woman has low oximetry. Refer urgently to the hospital!\",\"toaster_info_text\":\"Procedure:\\n- Give oxygen\\n- Refer urgently to hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"cardiac_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Cardiac exam\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"cardiac_exam_sub_form\",\"openmrs_entity_parent\":\"165368AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster22\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal cardiac exam. Refer urgently to the hospital!\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"breast_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165369AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Breast exam\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165369AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165369AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"breast_exam_sub_form\",\"openmrs_entity_parent\":\"165369AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster23\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal breast exam. Refer for further investigation.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"abdominal_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165370AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Abdominal exam\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165370AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165370AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"abdominal_exam_sub_form\",\"openmrs_entity_parent\":\"165370AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster24\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal abdominal exam. Consider high level evaluation or referral.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"pelvic_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165373AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Pelvic exam (visual)\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"3\",\"options\":[{\"key\":\"1\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165373AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"2\",\"text\":\"Normal\",\"openmrs_entity_parent\":\"165373AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1115AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"3\",\"text\":\"Abnormal\",\"specify_info\":\"specify...\",\"specify_widget\":\"check_box\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"pelvic_exam_sub_form\",\"openmrs_entity_parent\":\"165373AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1116AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster25\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal pelvic exam. Consider high level evaluation, specific syndromic treatment or referral.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"cervical_exam\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Cervical exam done?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"1\",\"options\":[{\"key\":\"1\",\"text\":\"Done\",\"openmrs_entity_parent\":\"165374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"1267AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"specify_info\":\"specify cm cervix dilated...\",\"specify_widget\":\"normal_edit_text\",\"specify_info_color\":\"#8C8C8C\",\"secondary_suffix\":\"cm\",\"content_form\":\"cervical_exam_sub_form\"},{\"key\":\"2\",\"text\":\"Not done\",\"openmrs_entity_parent\":\"165374AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"1118AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"toaster26_hidden\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}},\"src\":{\"key\":\"cervical_exam\",\"option_key\":\"1\",\"stepName\":\"step3\"}},\"value\":\"0\",\"step\":\"step3\",\"is-rule-check\":true},{\"key\":\"toaster26\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Cervix is more than 2 cm dilated. Please check for other signs and symptoms of labour (if GA is 37 weeks or later) or pre-term labour and other related complications (if GA is less than 37 weeks).\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}},\"is_visible\":false},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"oedema\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Oedema present?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"extra_rel\":true,\"has_extra_rel\":\"yes\",\"options\":[{\"key\":\"yes\",\"text\":\"Yes\",\"specify_info\":\"specify type...\",\"specify_widget\":\"radio_button\",\"specify_info_color\":\"#8C8C8C\",\"content_form\":\"oedema_present_sub_form\",\"openmrs_entity_parent\":\"460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"no\",\"text\":\"No\",\"openmrs_entity_parent\":\"460AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"is-rule-check\":false},{\"key\":\"oedema_severity\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Oedema severity\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"+\",\"text\":\"+\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1362AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"++\",\"text\":\"++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1363AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"+++\",\"text\":\"+++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1364AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"++++\",\"text\":\"++++\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1365AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"164494AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"v_required\":{\"value\":\"false\",\"err\":\"Please enter the result for the dipstick test.\"},\"relevance\":{\"step3:oedema\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"yes\\\")\"}},\"is_visible\":false}]},\"step4\":{\"title\":\"Fetal Assessment\",\"fields\":[{\"key\":\"sfh_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Symphysis-fundal height (SFH) in centimetres (cm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":false}},{\"key\":\"sfh\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1439AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_min\":{\"value\":\"0.1\",\"err\":\"SFH must be greater than 0\"},\"v_max\":{\"value\":\"44\",\"err\":\"SFH must be less than or equal to 44\"},\"v_numeric_integer\":{\"value\":\"true\",\"err\":\"Enter a valid sfh\"},\"v_required\":{\"value\":\"false\",\"err\":\"Please enter the SFH\"}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"fetal_movement\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165376AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Fetal movement felt?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"yes\",\"text\":\"Yes\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"165376AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"no\",\"text\":\"No\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"165376AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"v_required\":{\"value\":\"false\",\"err\":\"Please this field is required.\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"fetal_heartbeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165377AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Fetal heartbeat present?\",\"label_text_style\":\"bold\",\"text_color\":\"#000000\",\"options\":[{\"key\":\"yes\",\"text\":\"Yes\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"165377AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"},{\"key\":\"no\",\"text\":\"No\",\"value\":false,\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"165377AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Please specify if fetal heartbeat is present.\"}},{\"key\":\"fetal_heart_rate_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Fetal heart rate (kpm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":\"true\",\"err\":\"Please specify if fetal heartbeat is present.\"},\"relevance\":{\"step4:fetal_heartbeat\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"yes\\\")\"}}},{\"key\":\"fetal_heart_rate\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1440AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_min\":{\"value\":\"80\",\"err\":\"Fetal heartbeat must be equal or greater than 80\"},\"v_max\":{\"value\":\"200\",\"err\":\"Fetal heartbeat must be less than or equal to 200\"},\"v_numeric_integer\":{\"value\":\"true\",\"err\":\"Enter a valid sfh\"},\"relevance\":{\"step4:fetal_heartbeat\":{\"type\":\"string\",\"ex\":\"equalTo(., \\\"yes\\\")\"}},\"v_required\":{\"value\":\"true\",\"err\":\"Please specify if fetal heartbeat is present.\"}},{\"key\":\"toaster27\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"No fetal heartbeat observed. Refer to hospital.\",\"toaster_info_text\":\"Procedure:\\n- Inform the woman that you cannot find the heartbeat and need to refer her to check if there's a problem.\\n- Refer to hospital.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster28\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Fetal heart rate out of normal range (110-160). Please have the woman lay on her left side for 15 minutes and check again.\",\"text_color\":\"#D56900\",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"fetal_heart_rate_repeat_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"Second fetal heart rate (bpm)\",\"text_color\":\"#000000\",\"v_required\":{\"value\":true},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"fetal_heart_rate_repeat\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1440AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"normal_edit_text\",\"edit_text_style\":\"bordered\",\"edit_type\":\"number\",\"v_required\":{\"value\":\"true\",\"err\":\"Please enter result for the second fetal heart rate\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"toaster29\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Abnormal fetal heart rate. Refer to hospital.\",\"text_color\":\"#E20000\",\"toaster_type\":\"problem\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"no_of_fetuses_label\",\"type\":\"label\",\"label_text_style\":\"bold\",\"text\":\"No. of fetuses\",\"text_color\":\"#000000\",\"v_required\":{\"value\":false},\"relevance\":{\"step4:no_of_fetuses_unknown\":{\"ex-checkbox\":[{\"not\":[\"no_of_fetuses_unknown\"]}]}}},{\"key\":\"no_of_fetuses\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165293AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"numbers_selector\",\"number_of_selectors\":\"5\",\"start_number\":\"1\",\"max_value\":\"8\",\"text_size\":\"16px\",\"text_color\":\"#000000\",\"selected_text_color\":\"#ffffff\",\"v_required\":{\"value\":false},\"relevance\":{\"step4:no_of_fetuses_unknown\":{\"ex-checkbox\":[{\"not\":[\"no_of_fetuses_unknown\"]}]}},\"value\":\"4\",\"editable\":true,\"read_only\":true},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\",\"relevance\":{\"step4:no_of_fetuses_unknown\":{\"ex-checkbox\":[{\"not\":[\"no_of_fetuses_unknown\"]}]}}},{\"key\":\"spacer\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"spacer\",\"type\":\"spacer\",\"spacer_height\":\"10sp\"},{\"key\":\"no_of_fetuses_unknown\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165294AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"check_box\",\"options\":[{\"key\":\"no_of_fetuses_unknown\",\"text\":\"No. of fetuses unknown\",\"value\":\"false\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165294AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"}]},{\"key\":\"preeclampsia_risk\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"165260AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"hidden\",\"calculation\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-calculations-rules.yml\"}}}},{\"key\":\"toaster30\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"\",\"openmrs_entity_id\":\"\",\"type\":\"toaster_notes\",\"text\":\"Pre-eclampsia risk counseling\",\"text_color\":\"#D56900\",\"toaster_info_text\":\"The use of aspirin after 12 weeks gestation is recommended as well as calcium if low dietary intake area. Please also provide counseling. \",\"toaster_type\":\"warning\",\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}},{\"key\":\"fetal_presentation\",\"openmrs_entity_parent\":\"\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"160090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"type\":\"native_radio\",\"label\":\"Fetal presentation\",\"label_text_style\":\"bold\",\"label_info_text\":\"If multiple fetuses, indicate the fetal position of the first fetus to be delivered.\",\"options\":[{\"key\":\"unknown\",\"text\":\"Unknown\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"cephalic\",\"text\":\"Cephalic\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"160091AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"pelvic\",\"text\":\"Pelvic\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"146922AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"transverse\",\"text\":\"Transverse\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"112259AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"},{\"key\":\"other\",\"text\":\"Other\",\"value\":\"false\",\"openmrs_entity\":\"concept\",\"openmrs_entity_id\":\"5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\",\"openmrs_entity_parent\":\"\"}],\"v_required\":{\"value\":\"true\",\"err\":\"Fetal representation field is required\"},\"relevance\":{\"rules-engine\":{\"ex-rules\":{\"rules-file\":\"physical-exam-relevance-rules.yml\"}}}}]},\"global\":{\"site_ipv_assess\":true,\"site_anc_hiv\":true,\"site_ultrasound\":true,\"site_bp_tool\":true,\"pop_undernourish\":true,\"pop_anaemia_40\":true,\"pop_anaemia_20\":false,\"pop_low_calcium\":true,\"pop_tb\":true,\"pop_vita\":true,\"pop_helminth\":true,\"pop_hiv_incidence\":false,\"pop_hiv_prevalence\":false,\"pop_malaria\":true,\"pop_syphilis\":false,\"pop_hepb\":true,\"pop_hepb_screening\":true,\"pop_hepc\":true,\"gest_age_openmrs\":\"13\",\"gest_age\":\"\",\"urine_glucose\":\"\",\"previous_contact_no\":\"2\",\"gdm\":\"\",\"health_conditions\":\"[blood_disorder, epilepsy, hiv]\",\"last_contact_date\":\"18-02-2020\",\"contact_no\":\"3\",\"current_weight\":\"\",\"hb_result\":\"\",\"dm_in_preg\":\"\",\"prev_preg_comps\":\"[convulsions, tobacco_use, vacuum_delivery, 3rd_degree_tear]\",\"urine_nitrites\":\"\",\"age\":\"10\",\"previous_current_weight\":\"56\"},\"invisible_required_fields\":\"[bp_systolic_repeat_label, symp_sev_preeclampsia, pulse_rate_repeat, cant_record_bp_reason, bp_systolic_repeat, body_temp_repeat_label, urine_protein, bp_diastolic_repeat_label, pulse_rate_repeat_label, bp_diastolic_repeat, body_temp_repeat]\"}";
        MainContactActivity mainContactActivitySpy = Mockito.spy(MainContactActivity.class);
        Whitebox.setInternalState(mainContactActivitySpy, "contactNo", 2);
        Set<String> globalKeys = new HashSet<>();
        globalKeys.add("respiratory_exam");
        globalKeys.add("respiratory_exam_abnormal");
        globalKeys.add("respiratory_exam_abnormal_other");
        globalKeys.add("body_temp_repeat");
        globalKeys.add("pulse_rate_repeat");
        Whitebox.setInternalState(mainContactActivitySpy, "globalKeys", globalKeys);

        Whitebox.invokeMethod(mainContactActivitySpy, "processRequiredStepsField", new JSONObject(partialForm));
        Map<String, Integer> requiredFieldsMap = Whitebox.getInternalState(mainContactActivitySpy, "requiredFieldsMap");
        Assert.assertEquals(1, requiredFieldsMap.size());
        Integer numberRequired = requiredFieldsMap.get("Physical Exam");
        Assert.assertTrue(requiredFieldsMap.containsKey("Physical Exam"));
        Assert.assertEquals(Integer.valueOf(9), numberRequired);
    }

    @After
    public void tearDown() {
        destroyController();
    }
}
